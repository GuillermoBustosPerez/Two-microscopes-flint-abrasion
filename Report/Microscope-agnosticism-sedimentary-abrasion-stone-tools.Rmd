---
title: "Microscope agnosticism and the characterization of sedimentary abrasion of
  flint stone tools"
output:
    md_document:
      variant: gfm
bibliography: "References.bib"
csl: "elsevier-harvard.csl"
link-citations: true
linkcolor: blue
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


Guillermo Bustos-Pérez $^{1,2,3}$, Andreu Olle $^{2,3}$    



<div align="justify">   

## Abstract   

The surface of lithic stone tools from Paleolithic archaeological sites can undergo a range of different postdepositional alterations, including sedimentary erosion induced by water displacement or wind. The surface of flint artifacts can reflect these alterations as changes in texture. Microscopic analyses and grayscale images can be employed to obtain quantitative data to help determine the degree to which the surfaces of flint stone tools have been altered. However, surface quantitative values depend directly on the image capturing system of each microscope. This raises the question of whether the quantitative values are actually capturing the evolution of the surface, whether they are dependent on the type of microscope and its image capturing system, and whether the detection of the degree of abrasion might vary depending on the type of microscope. The present work sought to determine whether data extracted from images from two different microscopes point to the same trends in surface change due to postdepositional alterations. Surface photographs of a sample of 25 flakes were taken using a Dino-Lite Edge 3.0 AM73915MZT and a 3D Optical Profiler Sensofar S neox 090. These flakes represented three different stages of alteration (fresh, ten hours of experimentally-induced sedimentary erosion, and geological neocortex). Results from grayscale images indicate that, despite yielding different numeric ranges, the quantitative values of the images from both types of microscope reflect the same trends in surface change. The classification accuracy of the three stages of erosion did not vary between microscopes.   

**Key words**: microscopic analysis; lithic analysis; lithic taphonomy; postdepositional surface modifications    

## 1) Introduction     

Flint stone tools are among the most common remains recovered from Paleolithic sites. They provide information not only about chrono-cultural developments, but also about the behavioral and spatial organization of Paleolithic groups. However, stone tools from Paleolithic sites may be subjected to any number of postdepositional alterations, most commonly water flow or wind abrasion [byers_flake_2015; @hosfield_flake_2016; @michel_freezing_2019; @petraglia_water_1994; @schick_stone_1986]. These postdepositional processes can disrupt archaeological remains, resulting in horizontal and vertical mixing of artifacts and, consequently, unreliable chrono-cultural interpretations. Therefore, a solid analysis of the integrity of a lithic assemblage is needed prior to its interpretation.   

Postdepositional alterations and their intensity are recorded on the surface of stone tools, most commonly observed in the form of increased ridge width and surface abrasion [@burroni_surface_2002; @bustos-perez_experimental_2019; @bustos-perez_quantification_2024; @chambers_like_2016; @shackley_stream_1974]. Unaided visual assessments of sedimentary abrasion (rounding) can result in an error ratio of over 80%, emphasizing the need for microscopic analyses with quantitative variables [@chambers_like_2016].   

The quantitative characterization of surfaces is an important part of many lithic microscopic analytical approaches. In recent traceological studies, surface texture quantification is often used to identify worked materials [@evans_laser_2008; @ibanez_identifying_2019; @ibanez_quantitative_2021; @macdonald_application_2014; @sferrazza_grey_2023; @stemp_discrimination_2011; @stevens_practical_2010] or test different models of polish development [@ibanez_quantitative_2021]. Another area of lithic microscopic analysis in which surface quantification plays a key role is in the identification, characterization and estimation of the intensity of postdepositional alterations on lithic artifacts [@burroni_surface_2002; @bustos-perez_experimental_2019; @caux_aspects_2018; @chambers_like_2016; @chu_micro-abrasion_2015; @hiscock_need_1985; @hosfield_interpreting_2000; @levi_sala_use_1986]. The development of these analyses has been incorporated in studies focusing on the integrity of the lithic artifacts in archaeological assemblages [@fraile-marquez_facing_2022; @galland_quantifying_2019; @staurset_post-depositional_2023].   

Recent approaches using sequential experimentation, grayscale images [@bustos-perez_quantification_2024; @sferrazza_grey_2023] and texture metrics [@haralick_textural_1973] have demonstrated the viability of quantifying surface changes caused by sedimentary abrasion on flint tools. However, the information contained in the pixels of a photograph may vary according to the capturing system of each microscope. This raises the issue of the importance of microscope agnosticism (meaning that metric values or trends do not vary in relation to the choice of microscope). In the present study, we explored four aspects to explore the issue of microscope agnosticism in relation to sedimentary abrasion.    

  1) Observed trends in quantitative metrics should be consistent independent of the choice of microscope. The combination of sequential experimentation and quantitative metrics [@bustos-perez_quantification_2024; @ibanez_quantitative_2021; @olle_use_2014] has resulted in a certain degree of confidence regarding how the surface of flint changes progressively as result of a mechanical action. However, the current understanding of this change is directly related to the image acquisition procedure and the quantitative variables derived from those images. Ideally, quantitative trends would remain consistent regardless of the type of microscope used.    
  
  2) Collinearity or multicollinearity of metric features extracted from images should be considered. Several approaches [@bustos-perez_quantification_2024; @ibanez_quantitative_2021; @pedergnana_polish_2020; @sferrazza_grey_2023; @stevens_practical_2010] use machine learning (ML) classification algorithms on metric features extracted from images. Along with higher accuracy, one substantial advantage of ML algorithms is that they can provide insights into feature importance for classification. Collinearity is generally not considered problematic for classification metrics, provided that any collinearity present in the training set is also present in the predicted sample. However, collinearity is considered to have substantial effects on interpreting feature importance due to unstable coefficients or redundancy in feature selection. Thus, it is important to be aware of the presence of collinear or multicollinear variables when using quantitative features extracted from images. Images of the same area from different microscopes will vary depending on the image acquiring system, and as a consequence, the presence of collinearity among the extracted features is also expected to vary from microscope to microscope. A microscope generating images with fewer pairs of collinear variables can be considered more reliable for the quantitative characterization of a surface.   
  
  3) Classification accuracy should remain similar despite the use of variables obtained from the images of different microscopes. Accuracy can be affected when multicollinearity is present among the variables. A common approach to this problem is the use of dimensionality reduction methods (PCA, t-SNE; @naes_understanding_2001), which make it possible to combine multiple collinear variables while avoiding the loss of information. If multicollinearity is present, the accuracy of a model using raw variables should be compared with a model using dimensionally reduced variables.    
  
  4) Consistency of variable importance among classification algorithms and photographs obtained from different microscopes is a good indicator of microscope agnosticism. However, as previously indicated, variable importance can be affected by collinearity among predictors. This is an important consideration since the importance of a pair of variables might be a result of their collinearity. Additionally, it makes it possible to consider which groups of metric variables should be emphasized when analyzing surface change due to a given mechanical action.    
  
## 2) Methods   

### 2.1) Experimental sample and cleaning protocol    

The sample consisted of 25 flakes experimentally knapped by one of the authors (GBP) using direct percussion with a hard hammer. The flakes came from three different types of flint (Table 1), all of them south Madrid Miocene flint [@bustillo_caracterizacion_2012; @bustillo_caracteristicas_2005] from different locations. South Madrid Miocene flints were formed by the replacement of sedimentary rocks which had filled the original basin, which is thought to have taken place under continental conditions such as alluvial plain deposits, shallow lacustrine waters, and marshes [@bustillo_caracterizacion_2012]. Macroscopic analysis of the flints shows that they present a fine, opaque, homogeneous surface and blue/grey and reddish/ocher coloration. There is also a relative absence of opal in these flints, although geodes and pseudo-morphs are sometimes present.    

```{r, message=FALSE, warning=FALSE}
library(tidyverse); library(caret)
load("Data/Data-Both-micro-v3.RData")

Data %>% 
  group_by(Flint.Type, Flake.Time) %>% 
  summarise(n_distinct(Flake.ID))
```

Five type 1 and 2 flakes were analyzed to obtain images of the fresh surface, while four type 1 flakes and five type 2 flakes were submitted to ten hours of rounding in a tumbling machine (KT-3010 SUPER-TUMBLER). The sedimentary matrix employed to simulate rounding consisted of a mix of sand and water (a total weight of 5 kg of which 30–40% was water). Sediment was obtained from the quaternary levels of the Madrid basin and was made up of fine quartz sands with silt and partial carbonation. The tumbler machine was set at continuous direction at 83 rpm. The average weight of the flakes introduced into the tumbler was 26.25 g.    

Geological images of the neocortex were obtained from three type 3 flakes and three type 2 flakes (Table 2). These images of geological neocortex serve as reference samples for extreme levels of sedimentary abrasion.    

![Sample of experimental materials before and after 10h of sedimentary abrasion (photographs by M. D. Guillén).](Figures/01-Presenting-materials.png)
 
 Possible contaminants were removed by means of a multi-step procedure based on a previous study [@pedergnana_modern_2016. The present study used a two-step procedure consisting of an ultrasonic bath (frequency of 40 kHz) in a 2% neutral soap (Derquim) solution for 10 to 15 minutes, followed by a second sonic bath in pure acetone for another 10 to 15 minutes. After each step, the lithic artifacts were placed in a tap water bath and finally dried using compressed air. During the cleaning protocol and microscopic analysis, all artifacts were handled using powder-free surgical gloves. 

```{r}
Data %>% group_by(Microscope, Flake.Time) %>% 
  summarise(Phot.Per.Time = n())
```

### 2.2) Image acquisition and processing     

In order to compare images, the field of view (FOV) and pixel ratio of both microscopes must be as similar as possible. Parameters of the Dino-Lite Edge 3.0 AM73915MZT were kept the same as in previous experiments [@bustos-perez_quantification_2024], with a FOV of 3.28 x 2.46 mm and a pixel ratio of 2548 x 1918. As a result, each pixel measured 1.28 μm (width) by 1.28 μm (height). The Dino-Lite Edge 3.0 AM73915MZT microscope was mounted in a Dino-Lite RK-06-AE stand in order to ensure verticality, and a N3C-D2 diffuser cap was used to ensure the even distribution of light. In the process of taking each photograph, the region of interest on the flint was manually positioned as horizontally as possible [@calandra_surface_2022]. To avoid problems due to focus variation, each surface was photographed several times at different heights, and the sequences obtained were mounted using a Helicon Focus 7.7.2. Normally, satisfactory stacking required between two and four images, although additional images were employed when needed.    

![Example of two images from the same neocortex surface. Left: Sensofar S neox 090; right: Dino-Lite Edge 3.0 AM73915MZT. Both images after processing using Fiji/ImageJ](Figures/02-Neocortex-comparision.png)

The Sensofar S neox 090 zoom was manually adjusted to the most similar FOV (3.18 x 2.65 mm) with 2x2 mosaics taken for each image. All images were obtained using a x10 objective lens (numerical aperture 0.30) in light scanning confocal mode (microdisplay scanning confocal microscopy) at 5 Mp resolution with at least 95% of the information retrieved. The original Sensofar S neox 090 photographs had a pixel ratio of 4616 x 3848. This resulted in each pixel measuring 0.69 x 0.69 μm. In order to match the FOV and pixel ratio of the Sensofar S neox 090 zoom to those of MP previous studies [@bustos-perez_quantification_2024], the images were cropped and the pixels downsampled. Although the images from the Dino-Lite Edge 3.0 AM73915MZT microscope were slightly wider (0.10 mm), this resulted in almost identical FOV, pixel ratios and pixel widths/heights (Table 3).    

Both sets of images underwent the same two-step image treatment procedure employed in a previous study [@bustos-perez_quantification_2024]. First, the Fiji [@schindelin_imagej_2015] “subtract background” plugin was used to minimize the effects of different lighting and differing flint coloration. Second, the “enhance contrast” function was used to desaturate the images by normalizing their histograms. This process provided a gray-level image for use as input for the statistical analysis. All analyzed images were in TIFF format.     

\ 

![Example of two images of the same flint fresh surface. Left: Sensofar S neox 090; right: Dino-Lite Edge 3.0 AM73915MZT. Both images after processing using Fiji/ImageJ.](Figures/03-Comparing-fresh-surface.png)
\ 

![Examples of heavily developed abrasion. Images are of the same flint. Both images after processing using Fiji/ImageJ.](Figures/04-Comparing-abraded.png)
\ 

Photographs of fresh and neocortex surfaces were obtained in the same areas with both microscopes. The surface of the flakes that had undergone 10h of rounding was initially recognized with both types of microscopes and the most-developed surfaces were photographed. This is a common procedure when analyzing microscopic traces, as the most-developed area [@ibanez_quantitative_2021; @pedergnana_polish_2020] is targeted for photography. This ensured the maximum visibility of the abrasion for each microscope.    

```{r}
kableExtra::kable(
  data.frame(
  `Microscope images` = c("AM73915MZT", "S neox 090 (original images)", "S neox 090(transformed)"),
  `Image aspect ratio` = c(1.33, 1.19, 1.33),
  `FOV (mm)` = c("3.28 x 2.46", "3.18 x 2.65", "3.18 x 2.46"),
  `Pixel Ratio` = c("2548 x 1918", "4616 x 3848", "2480 x 1918"),
  `Pixel width height (μm)` = c("1.28 x 1.28", "0.69 x 0.69", "1.28 x 1.28"))
) 
```


### 2.3) Quantitative analysis        

Three groups of metrics were extracted from the microscope images (Table 4). The first group corresponds to descriptive statistics of the gray-level values in each image, which can be divided into measures of central tendency (mean, mode and median), and measures of deviation and distribution (standard deviation, kurtosis and skewness).    

```{r}

kableExtra::kable(
  data.frame(
  Name = c("Mean", "Mode", "Median", "Standard Deviation", "Skewness", "Kurtosis", "RMS deviation/roughness", "Arithmetical mean deviation", "Skewness assessed profile", "Kurtosis assessed profile", "Angular second moment", "Contrast", "Correlation", "Inverse different moment", "Entropy"),
  Acronym = c("x̄", "Mo", "m", "SD", "Sk", "Ku", "Rq", "Ra", "Rsk", "Rku", "ASM", "CONT", "CORR", "IDM", "ENT"),
  Group = c("C", "C", "C", "D&D", "D&D", "D&D", "R", "R", "R", "R", "T", "T", "T", "T", "T"),
  Description = c("Central tendency of the sample", "Most repeated value", "Value of at least half the sample", "Variation expected from the mean", "Asymmetry of the distribution", "Tailedness of the distribution", "Indicator of surface roughness", "Deviation of a surface from a mean height", "Indicator of the departure from surface symmetry", "Sharpness of the peaks", "Measure of homogeneity in the image", "Indicative of local variations", "How a reference pixel is related to its neighbor", "Closeness of the distribution of the GLCM elements to the GLCM diagonal.", "Amount of irremediable chaos or disorder in an image")
  )
)
```

The second group corresponds to measures of roughness. The Fiji/ImageJ [@collins_imagej_2007; @schindelin_imagej_2015; @schindelin_fiji_2012] SurfCharJ plugin [@chinga_roughness_2002; @chinga_quantification_2007] was employed to obtain measures of Rq (root mean square deviation/roughness), Ra (arithmetical mean deviation), Rsk (skewness of the assessed profile) and Rku (kurtosis of the assessed profile). Profiles of the whole surface (those with the “R” prefix) were employed as input, and measures were calculated following the ISO 4287/2000 standard [@chinga_roughness_2002; @chinga_quantification_2007].     

Texture measures take into consideration the spatial distribution and intensity values of the pixels from a grayscale image [@haralick_textural_1973]. The spatial distribution and intensity are analyzed through a gray-level covariance matrix (GLCM). This process works in two steps. First, for a given distance and direction, a matrix is built that captures the relationship of intensity between pairs of pixels (reference and neighbor). Second, for every x and y it considers the co-occurrence of values, forming a new matrix. This matrix makes it possible to obtain a series of statistical descriptors [@haralick_textural_1973]: the angular second moment (ASM), contrast (CONT), correlation (CORR), inverse different moment (IDM) and entropy (ENT). Based on previous studies [@bustos-perez_quantification_2024], four distances (5, 10, 15 and 20 pixels) and all four possible directions (north, east, south, west) were employed to create the GLCM and extract the features.    

Two procedures were used to address the issue of collinearity among the predictors. The first of these was the removal of collinear variables using a pairwise cutoff discard procedure with a matrix representing the linear correlation ($r^2$) of each pair of variables. For pairs of variables presenting a correlation above a given threshold, the variable presenting the highest average correlation (among all variables) was removed. An arbitrary cutoff threshold of 0.9 was selected. A visual evaluation of variable relationships showed that this threshold prevented the exclusion of pairs of variables presenting polynomial or logarithmic relationships. In the second procedure, dimensionality was reduced through a principal component analysis (PCA), which identifies the linear combinations that best represent the variables in an unsupervised manner [@james_introduction_2013; @pearson_lines_1901]. Principal components (PCs) capture as much variance as possible for the complete dataset. This is especially useful when several collinear variables will be combined as a single variable, as it ensures a minimum loss of information [@james_introduction_2013; @yang_why_2003]. Consistency among the variable trend of data from both microscopes was evaluated through visual exploratory analysis and statistical differences between each consecutive episode of abrasion.     

A previous study [@bustos-perez_quantification_2024] using the same type of metrics showed that the linear discriminant analysis (LDA) provided the best results for classification. LDA reduces the dimensionality of the data aiming to maximize the separation between classes while decision boundaries divide the predicted classes into regions [@fisher_use_1936; @james_introduction_2013]. In the present study, three sets of LDA models were trained for each group of images. The first model was trained using the complete set of variables, second model was trained using the set of variables remaining from the pairwise cutoff to avoid collinearity, and the third model was trained after conducting a PCA for dimensionality reduction.     
All models were evaluated using 10 x 50 k-fold cross-validation (10 folds and 50 cycles), which provided measures of accuracy. Using a 10-fold division, each fold from the Dino-Lite Edge 3.0 AM73915MZT images was composed of 26 images, while each fold from Sensofar S neox 090 was composed of 28 images. Each fold subsequently acted as a test set for a trained model. Although computationally more expensive, this guaranteed that all data points served as test sets. At the start of each of the 50 cycles, and prior to fold division, the images were randomly shuffled, ensuring that the composition of the folds varied in each cycle and that composition did not play a significant role in the evaluation of the models.   
Two measures were selected for the evaluation of the machine learning models: accuracy and area under the curve (AUC). Accuracy indicates the success rate of a model, representing the proportion of times in which a class was correctly identified [@lantz_machine_2019]. Accuracy is usually calculated using a 0.5 threshold for class assignation. However, classification thresholds can be modified to balance the ability of the model to detect true positives and avoid false positives (sensitivity and specificity). The receiver operating characteristic (ROC) curve makes it possible to systematically evaluate the ratio of detected true positives, while avoiding false positives, for a given threshold [@bradley_use_1997; @spackman_signal_1989]. The ROC curve makes it possible to calculate the area under the curve (AUC) with a value that can range from 1 (perfect classifier) to 0, and a value of 0.5 representing a random classifier. In the present study, only the general AUC value of model performance was considered. The general AUC was calculated from the average of each AUC class [@hand_simple_2001; @robin_proc_2011].   
Machine learning models make it possible to estimate the importance of variables for classification. In the present study, variable importance was calculated only for LDA models trained on non-collinear sets of variables.    

The statistical study was conducted using R version 4.3.1 in the IDE RStudio version 2023.09.0 [@r_core_team_r_2019; @rstudio_team_rstudio_2019]. Data were managed and graphs created using the tidyverse v.2.0.0 package [@wickham_welcome_2019]. LDA models were trained using MASS (Modern Applied Statistics with S) v.7.3.60 [@venables_modern_2002]. The k-fold cross validation of all models, precision metrics, the pairwise discard of collinear variables, and variable importance were performed using the caret package v.6.0.94 [@kuhn_building_2008]. ROC curves and AUC values were obtained using the pROC v.1.18.5 package [@robin_proc_2011].   
Currently, all data, code and the complete workflow needed to perform the analysis is made freely available as an open repository at Github using an RMarkdown document [@xie_knitr_2014; @xie_r_2018]. If the current draft is accepted for publication, the repository will be made available at Zenodo.   

## 3) Results    

### 3.1) Trends of metric variables     

	Table 5 summarizes the observed trends and consistency between microscopes for the variables employed in the analysis. Images from the Dino-Lite Edge 3.0 AM73915MZT show clear trends for all variables and for all three stages of mechanical action considered. The interpretation of the images from the Sensofar S neox 090 was not nearly as clear, with no statistical differences between stages of abrasion for several of the variables.    
Clear consistency between microscopes was observed for seven variables (mean of pixel values, standard deviation, Sk, Ku, Rq, Ra and CONT) in the form of the same trends and marked statistical differences between values of variables according to stage of abrasion. Two additional variables (median and CORR) presented p values at the limit of significant statistical difference, with the presence of several outliers obfuscating the apparent trends among values.    

```{r}
kableExtra::kable(
  data.frame(
  Feature = c("x̄", "Mo", "m", "SD", "Sk", "Ku", "Rq", "Ra", "Rsk", "Rku", "ASM", "CONT", "CORR", "IDM", "ENT"),
  Sensofar = c("Increase", "Increase", "No trend", "Increase", "Decrease", "Decrease", "Increase", "Increase", "No trend", "No trend", "No trend", "Increase", "Increase", "No trend", "No trend"),
  Dinolite = c("Increase", "Increase", "Increase", "Increase", "Decrease", "Decrease", "Increase", "Increase", "Decrease", "Decrease", "Decrease", "Increase", "Decrease", "Decrease", "Increase"),
  Consistency = c("Yes", "Yes", "No", "Yes", "Yes", "Yes", "Yes", "Yes", "No", "No", "No", "Yes", "Yes", "No", "No"))
  )

```

Visual analysis of the values in box plots makes it possible compare the evolution of trends among the different groups of variables and compare microscope consistency (Figure 5; Figure 6; Figure 7; Figure 8). A tendency of increasing values was observed among the three measures of central tendency in the Dino-Lite Edge 3.0 AM73915MZT images (Figure 5). The images of geological neocortex from the Sensofar S neox 090 tended to have higher mean and median values than images of fresh flakes and those exposed to 10 hours of abrasion. However, no statistical difference was found between the median values of the images of fresh flint images and those of flakes after 10 hours of rounding (t = -0.73; p = 0.46), although there was a statistical difference for the mean values of the same two categories (t = -9.80; p < 0.01). As expected, the modal of the distribution was the least reliable variable, with the mode consistently having a value of 0 for all Sensofar S neox 090 images.    

```{r}
Data %>% 
  select(Mean, Modal, Median, Flake.Time, Microscope) %>% 
  pivot_longer(
    Mean:Median,
    names_to = "Variables",
    values_to = "values") %>% 
  mutate(Variables = factor(Variables, levels = c("Mean", "Median", "Modal")),
         Flake.Time = factor(Flake.Time, levels = c("Fresh", "Ten.Hours", "Neocortex"),
                             labels = c("Fresh", "10 h", "Neocortex"))) %>% 
  
  ggplot(aes(Flake.Time, values, fill = Microscope)) +
  theme_light() +
  geom_violin(width = 0.4, alpha = 0.5) +
  geom_boxplot(outlier.shape = NA, outlier.colour = NA,  width = 0.4) +
  xlab(NULL) +
  ylab("Values") +
  ggsci::scale_fill_nejm() +
  geom_jitter(aes(fill = Microscope), width = 0.15, height = 0, 
              shape = 23, alpha = 0.5, color = "black") +
  ggh4x::facet_grid2(Microscope ~ Variables,
                     scales = "free_y", independent = "y") +
  theme(
    legend.position = "none",
    strip.text = element_text(color = "black", face = "bold", size = 11),
    strip.background = element_rect(fill = "white", colour = "black", linewidth = 1),
    axis.text = element_text(color = "black", size = 10)
  )
```


 The images from both microscopes demonstrated a much better trend consistency for variables capturing the deviation and distribution of values (Figure 6). Standard deviation and kurtosis showed marked statistically significant trends (increase and decrease respectively) for both types of microscopes. The skewness values of the Sensofar S neox 090 images for fresh flint and flint subjected to 10 hours of rounding presented slight statistical differences (t = 2.15; p = 0.03).    
 
```{r}
Data %>% 
  select(SD, Skewness, Kurtosis, Flake.Time, Microscope) %>% 
  pivot_longer(
    SD:Kurtosis,
    names_to = "Variables",
    values_to = "values") %>% 
  mutate(Variables = factor(Variables, levels = c("SD", "Skewness", "Kurtosis")),
         Flake.Time = factor(Flake.Time, levels = c("Fresh", "Ten.Hours", "Neocortex"),
                             labels = c("Fresh", "10 h", "Neocortex"))) %>% 
  
  ggplot(aes(Flake.Time, values, fill = Microscope)) +
  theme_light() +
  geom_violin(width = 0.4, alpha = 0.5) +
  geom_boxplot(outlier.shape = NA, outlier.colour = NA,  width = 0.4) +
  xlab(NULL) +
  ylab("Values") +
  ggsci::scale_fill_nejm() +
  geom_jitter(aes(fill = Microscope), width = 0.15, height = 0, 
              shape = 23, alpha = 0.5, color = "black") +
  ggh4x::facet_grid2(Microscope ~ Variables,
                     scales = "free_y", independent = "y") +
  theme(
    legend.position = "none",
    strip.text = element_text(color = "black", face = "bold", size = 11),
    strip.background = element_rect(fill = "white", colour = "black", linewidth = 1),
    axis.text = element_text(color = "black", size = 10)
  )
```
 
Only two features of roughness were consistent between the two microscopes (Rq and Ra). Images from the Dino-Lite Edge 3.0 AM73915MZT showed a clear trend of increasing values as sedimentary abrasion progresses. This trend was less marked in the Sensofar S neox 090 images, although there were statistically significant differences in Rq values (t = -3.86, p < 0.01) between fresh flint and flint subjected to ten hours of rounding. The statistical significance between these stages of sedimentary abrasion was less marked for the Ra values (t = -2.21, p = 0.02). Although Rsk, and Rku presented clear trends of diminishing values in the case of the Dino-Lite Edge 3.0 AM73915MZT images, no statistically significant difference was observed between fresh flint values and those of flint after 10 hours of rounding for the Sensofar S neox 090 images (t = -1.42, p = 0.16; t = -0.47, p = 0.64).    

```{r}
Data %>% 
  select(Rq:Rku, Flake.Time, Microscope) %>% 
  pivot_longer(
    Rq:Rku,
    names_to = "Variables",
    values_to = "values") %>% 
  mutate(Variables = factor(Variables, levels = c("Rq", "Ra", "Rsk", "Rku")),
         Flake.Time = factor(Flake.Time, levels = c("Fresh", "Ten.Hours", "Neocortex"),
                             labels = c("Fresh", "10 h", "Neocort."))) %>% 
  
  ggplot(aes(Flake.Time, values, fill = Microscope)) +
  theme_light() +
  geom_violin(width = 0.4, alpha = 0.5) +
  geom_boxplot(outlier.shape = NA, outlier.colour = NA,  width = 0.4) +
  xlab(NULL) +
  ylab("Values") +
  ggsci::scale_fill_nejm() +
  geom_jitter(aes(fill = Microscope), width = 0.15, height = 0, 
              shape = 23, alpha = 0.5, color = "black") +
  ggh4x::facet_grid2(Microscope ~ Variables,
                     scales = "free_y", independent = "y") +
  theme(
    legend.position = "none",
    strip.text = element_text(color = "black", face = "bold", size = 11),
    strip.background = element_rect(fill = "white", colour = "black", linewidth = 1),
    axis.text = element_text(color = "black", size = 10)
  )

```

```{r}
Data %>% 
  select(ASM:ENT, Flake.Time, Microscope) %>% 
  pivot_longer(
    ASM:ENT,
    names_to = "Variables",
    values_to = "values") %>% 
  mutate(Variables = factor(Variables, levels = c("ASM", "CONT", "CORR", "IDM", "ENT")),
         Flake.Time = factor(Flake.Time, levels = c("Fresh", "Ten.Hours", "Neocortex"),
                             labels = c("Fresh", "10 h", "Neocort."))) %>% 
  
  ggplot(aes(Flake.Time, values, fill = Microscope)) +
  theme_light() +
  geom_violin(width = 0.4, alpha = 0.5) +
  geom_boxplot(outlier.shape = NA, outlier.colour = NA,  width = 0.4) +
  xlab(NULL) +
  ylab("Values") +
  ggsci::scale_fill_nejm() +
  geom_jitter(aes(fill = Microscope), width = 0.15, height = 0, 
              shape = 23, alpha = 0.5, color = "black") +
  ggh4x::facet_grid2(Microscope ~ Variables,
                     scales = "free_y", independent = "y") +
  theme(
    legend.position = "none",
    strip.text = element_text(color = "black", face = "bold", size = 11),
    strip.background = element_rect(fill = "white", colour = "black", linewidth = 1),
    axis.text = element_text(color = "black", size = 10)
  )
```

One of the textural features (CONT) presented good consistency of trend evolution in images from both microscopes (Figure 8), and a relatively good pattern was observed in a second such feature (CORR). Images from both microscopes presented a decrease in angular second moment (ASM) values, although this decrease was much more pronounced among the images obtained from the Dino-Lite Edge 3.0 AM73915MZT. For the Sensofar S neox 090, there was a statistically significant difference between the images of fresh flint and flint after 10 hours of rounding (t = -2.04, p = 0.04), although this significance was not present in images of flint after 10 hours of rounding and neocortex (t = -0.79, p = 0.43), which may be the result of the presence of abundant outliers in the neocortex category. Contrast (CONT) presented the best example of consistency of all the variables, with the values of images from both microscopes presenting a clear increasing trend as sedimentary abrasion increased. Correlation (CORR) presented the clearest example of an inverse trend between the microscopes. Values of images from the Sensofar S neox 090 showed a clear increasing trend (within a wide range of distribution), while values from the Dino-Lite Edge 3.0 AM73915MZT images showed a decreasing trend and more concentrated values.    

Inverse different moment (IDM) showed a decrease in values for both groups of images, although the neocortex images from the Sensofar S neox 090 presented a wider range of distribution values, with no significant difference between fresh fling and flint after 10 hours of abrasion (t = 1.37; p = 0.17). No statistically significant difference was found between fresh flint and flint after 10 hours of abrasion in the Sensofar S neox 090 images (t = -1.2, p = 0.23) for entropy (ENT) either.   

### 3.2) Collinearity among features         

Figure 9 presents the results of correlation pairs between features for both types of microscopes. In general, a high level of correlation was observed among the features for both microscopes. For both microscopes, ASM presented very little correlation with other variables. The CORR feature presented little systematic correlation in the case of images from the Sensofar S neox 090 microscope, and ENT also presented little systematic correlation for the images from the Dino-Lite Edge 3.0 AM73915MZT microscope.     
The Sensofar S neox 090 presented nine variables exceeding the r2 = 0.9 cut-off threshold (standard deviation, median, Ku, Sk, Rsk, ASM, CORR, IDM and ENT), while the Dino-Lite Edge 3.0 AM73915MZT presented seven features below the cut-off threshold (median, modal, standard deviation, Rsk, ASM, CORR and ENT).    

```{r}
#### Collinearity plot of Sensofar images (91 possible combinations) ####
Data2 <- Data %>% filter(Microscope == "Sensofar.S.neox.090") %>% 
  select(-c(Modal))

r2 <- cor(Data2[,2:15], use = "complete.obs")^2
r2 <- round(r2,2)

### Correlation of dinolite variables (91 possible combinations) ####
Data3 <- Data %>% filter(Microscope == "Dinolite.Edge") %>% 
  select(-c(Modal))

r3 <- cor(Data3[, 2:15], use = "complete.obs")^2
r3 <- round(r3, 2)

((sum(r3 >= 0.9)-ncol(r3)))/2 # 22 pairs present correlation levels above 0.9

# Sort out correlated variables from the Dinolite
df.Test = cor(Data3[,2:15],  use = "complete.obs")^2
hc = findCorrelation(df.Test, cutoff = 0.9, names = TRUE,
                     exact = TRUE) 

reduced_Data = Data3 %>% select(-all_of(hc))
head(reduced_Data)

#### Two graphs together ####
ggpubr::ggarrange(
  
  (
    ggcorrplot::ggcorrplot(r2, 
                           type = "lower",
                           lab = TRUE,
                           title = "Sensofar S neox 090",
                           tl.cex = 6,
                           lab_size = 2.3) +
      ggsci::scale_fill_gsea(reverse = FALSE) +
      theme(legend.position = "none",
            plot.title = element_text(hjust = 0.5, size = 11, face = "bold"),
            axis.text = element_text(color = "black", size = 12))
  ),
  (
    ggcorrplot::ggcorrplot(r3, 
                           type = "lower",
                           lab = TRUE,
                           title = "Dino-Lite Edge 3.0 AM73915MZT",
                           tl.cex = 6,
                           lab_size = 2.3) +
      ggsci::scale_fill_gsea(reverse = FALSE) +
      theme(legend.position = "none",
            axis.text.y = element_blank(),
            plot.title = element_text(hjust = 0.5, size = 11, face = "bold"),
            axis.text = element_text(color = "black", size = 12))
  ),
  
  nrow = 1,
  ncol = 2,
  align = "hv"
)
```


### 3.3) LDA accuracy     

Dimensionality reduction through PCAs resulted in PC1 capturing 99.97% of variance for the set of images from both microscopes. PC2 captured 0.028% of variance for the Sensofar S neox 090 images and 0.022% of variance for the Dino-Lite Edge 3.0 AM73915MZT images.    

The following script allows to train the three types of models (all features, reduced number of features and PCA):

```{r eval=FALSE}
source("13-Training-LDA-models.R")
```

```{r}
load("Models/Dinolite-LDA-models.RData")
load("Models/Sensofar-LDA-models.RData")
```


Table 6 presents the results of LDA models for the three different sets of variables selected (complete set of variables, non-collinear variables and first three PCs) by microscope. In general, all models presented outstanding AUC values, and differences between model performance were minimal.    

```{r}
kableExtra::kable(
  data.frame(
  Variables = c("Complete", "Complete", "Non-Collinear", "Non-Collinear", "PCs", "PCs"),
  Metric = c("Accuracy", "AUC", "Accuracy", "AUC", "Accuracy", "AUC"),
  Sensofar = c(Senso.LDA$results[[2]], pROC::multiclass.roc(Senso.LDA$pred$obs, Senso.LDA$pred[,4:6])$auc[[1]],
               Senso.Reduced.LDA$results[[2]], pROC::multiclass.roc(Senso.Reduced.LDA$pred$obs, Senso.Reduced.LDA$pred[,4:6])$auc[[1]],
               Senso.PCA.LDA$results[[2]], pROC::multiclass.roc(Senso.PCA.LDA$pred$obs, Senso.PCA.LDA$pred[,4:6])$auc[[1]]),
  Dinolite = c(Dino.LDA$results[[2]], pROC::multiclass.roc(Dino.LDA$pred$obs, Dino.LDA$pred[,4:6])$auc[[1]],
               Dino.Reduced.LDA$results[[2]], pROC::multiclass.roc(Dino.Reduced.LDA$pred$obs, Dino.Reduced.LDA$pred[,4:6])$auc[[1]],
               Dino.PCA.LDA$results[[2]], pROC::multiclass.roc(Dino.PCA.LDA$pred$obs, Dino.PCA.LDA$pred[,4:6])$auc[[1]])
    )
) 
```

In the Sensofar S neox 090 images, no differences were observed between the classification metrics of the LDA model using the complete set of variables (accuracy = 0.853; AUC = 0.957) and the LDA model using non-collinear variables (accuracy = 0.851; AUC = 0.956). The accuracy of the LDA model trained on PCs was slightly lower (0.810), although the AUC value was practically equal to that of the other models (0.944). The LDA model trained on the whole set of variables from the Dino-Lite Edge 3.0 AM73915MZT images presented slightly higher values than the other models (accuracy = 0.89; AUC = 0.977). The LDA model trained on non-collinear variables and PCs using the Dino-Lite Edge 3.0 AM73915MZT images presented very similar accuracy (0.859 and 0.844) and AUC values (0.963 and 0.949).    

### 3.4) Feature importance    

Mean variable importance is presented in Figure 10. In general, there was good consistency in variable importance for classification, as standard deviation was considered the most important variable for classification in both sets of images. It is important to consider that the standard deviation was strongly correlated with the CONT textural feature in both groups of images (r2 = 0.98 and 0.92). This indicates that the degree of deviation in general (standard deviation) and in local space (CONT) is highly important in the characterization of abraded flint surfaces. The following second and third most important variables for the Sensofar S neox 090 group of images were kurtosis and skewness. For the Dino-Lite Edge 3.0 AM73915MZT images, kurtosis and skewness were strongly correlated with the CORR textural feature (r2 = 0.95 and 0.93), which is considered the second most important variable.   

```{r}
# Extract as data frame
Sens.Feat.Impo <- data.frame(varImp(Senso.Reduced.LDA, scale = TRUE)$importance)
Sens.Feat.Impo <- Sens.Feat.Impo %>% mutate(
  Variable = rownames(Sens.Feat.Impo),
  Mean.Importance = rowMeans(Sens.Feat.Impo[,1:3]))

# Calculate mean importance
Dino.Feat.Impo <- data.frame(varImp(Dino.Reduced.LDA, scale = TRUE)$importance)
Dino.Feat.Impo <- Dino.Feat.Impo %>% mutate(
  Variable = rownames(Dino.Feat.Impo),
  Mean.Importance = rowMeans(Dino.Feat.Impo[,1:3]))


colnames(Sens.Feat.Impo)
# Plot variable importance

ggpubr::ggarrange(
  (
    Sens.Feat.Impo %>% 
      ggplot(aes(Mean.Importance, reorder(Variable, Mean.Importance), fill = Mean.Importance)) +
      geom_bar(stat= "identity", position = "dodge") +
      geom_text(aes(label = round(Mean.Importance, 2)), 
                position = position_stack(vjust = 0.5), size = 3) +
      scale_fill_gradient(low = "red", high = "blue") +
      guides(fill = "none") +
      xlab("Mean Importance") +
      ylab(NULL) +
      ggtitle("Sensofar S neox 090") +
      theme_light() +
      theme(
        plot.title = element_text(hjust = 0.5, size = 10, face = "bold"),
        axis.text.y = element_text(color = "black", size = 10),
        axis.text.x = element_text(color = "black", size = 8),
        axis.title.x = element_text(color = "black", size = 11))
    ),
  (
    Dino.Feat.Impo %>% 
      ggplot(aes(Mean.Importance, reorder(Variable, Mean.Importance), fill = Mean.Importance)) +
      geom_bar(stat= "identity", position = "dodge") +
      geom_text(aes(label = round(Mean.Importance, 2)), 
                position = position_stack(vjust = 0.5), size = 3) +
      scale_fill_gradient(low = "red", high = "blue") +
      guides(fill = "none") +
      xlab("Mean Importance") +
      ylab(NULL) +
      ggtitle("Dino-Lite Edge 3.0 AM73915MZT ") +
      theme_light() +
      theme(
        plot.title = element_text(hjust = 0.5, size = 11, face = "bold"),
        axis.text.y = element_text(color = "black", size = 10),
        axis.text.x = element_text(color = "black", size = 8),
        axis.title.x = element_text(color = "black", size = 11))
  ))
```


The LDA model trained on the Sensofar S neox 090 images considered ENT the fourth most important variable for discrimination. ENT on the Dino-Lite Edge 3.0 AM73915MZT LDA model was correlated with IDM (r2 = 0.91) and with ASM (r2 = 0.87), the latter of which was considered the fourth most important variable in that model. A measure of central tendency (median) was considered equally important by both LDA models. On the Sensofar S neox 090 images, the median was highly correlated with the mean, the Rq and the Ra (r2 = 0.98, 0.98 and 1 respectively). This high level of correlation was shared in the Dino-Lite Edge 3.0 AM73915MZT LDA images along with the CONT textural feature (Figure 9).    

```{r}

ggpubr::ggarrange(
  (Data2 %>% 
     ggplot(aes(SD, Kurtosis, color = Flake.Time)) +
     geom_point(alpha = 0.7) +
     theme_light() +
     stat_ellipse(aes(color = Flake.Time), show.legend = FALSE) +
     scale_color_manual(
       values = c("blue", "orange", "firebrick"),
       labels = c("Fresh", "10h", "Neocortex"),
       name = "Flake time") +
     geom_label(aes(60, 5.65, label = "Sensofar S neox 090"),
                color = "black", fill = "white", size = 3, alpha = 0.5) +
     theme(
       legend.title = element_text(face = "bold", color = "black", size = 11),
       legend.text = element_text(color = "black", size = 10),
       axis.text = element_text(color = "black", size = 10),
       axis.title = element_text(color = "black", size = 10, face = "bold"))
   ),
  (Data3 %>% 
     ggplot(aes(SD, CORR, color = Flake.Time)) +
     geom_point(alpha = 0.7) +
     theme_light() +
     stat_ellipse(aes(color = Flake.Time), show.legend = FALSE) +
     scale_color_manual(
       values = c("blue", "orange", "firebrick"),
       labels = c("Fresh", "10h", "Neocortex"),
       name = "Flake time") +
     geom_label(aes(45, 0.0006, label = "Dino-Lite Edge 3.0 AM73915MZT"),
                color = "black", fill = "white", size = 3, alpha = 0.5) +
     theme(
       legend.title = element_text(face = "bold", color = "black", size = 11),
       legend.text = element_text(color = "black", size = 10),
       axis.text = element_text(color = "black", size = 10),
       axis.title = element_text(color = "black", size = 10, face = "bold"))
   ),
  
  common.legend = TRUE,
  legend = "bottom"
  )
```

Exploratory visual analysis of the combination of variables and the degree of sedimentary abrasion in scatter plots makes it possible to observe a consistency in the evolution of quantitative features (Figure 11; Figure 12). For both sets of images there is a clear separation between images of fresh surfaces and images of neocortex. In addition to this consistency, the images of flint surfaces subjected to ten hours of rounding are located in between the fresh and neocortex images, indicating the directionality of the process.    

```{r}
ggpubr::ggarrange(
  (Data2 %>% 
     ggplot(aes(SD, Skewness, color = Flake.Time)) +
     geom_point(alpha = 0.7) +
     theme_light() +
     stat_ellipse(aes(color = Flake.Time), show.legend = FALSE) +
     scale_color_manual(
       values = c("blue", "orange", "firebrick"),
       labels = c("Fresh", "10h", "Neocortex"),
       name = "Flake time") +
     geom_label(aes(60, 2, label = "Sensofar S neox 090"),
                color = "black", fill = "white", size = 3, alpha = 0.5) +
     theme(
       legend.title = element_text(face = "bold", color = "black", size = 11),
       legend.text = element_text(color = "black", size = 10),
       axis.text = element_text(color = "black", size = 10),
       axis.title = element_text(color = "black", size = 10, face = "bold"))
  ),
  (Data3 %>% 
     ggplot(aes(SD, Median, color = Flake.Time)) +
     geom_point(alpha = 0.7) +
     theme_light() +
     stat_ellipse(aes(color = Flake.Time), show.legend = FALSE) +
     scale_color_manual(
       values = c("blue", "orange", "firebrick"),
       labels = c("Fresh", "10h", "Neocortex"),
       name = "Flake time") +
     geom_label(aes(35, 94, label = "Dino-Lite Edge 3.0 AM73915MZT"),
                color = "black", fill = "white", size = 3, alpha = 0.5) +
     theme(
       legend.title = element_text(face = "bold", color = "black", size = 11),
       legend.text = element_text(color = "black", size = 10),
       axis.text = element_text(color = "black", size = 10),
       axis.title = element_text(color = "black", size = 10, face = "bold"))
  ),
  
  common.legend = TRUE,
  legend = "bottom"
)

```

## 4) Discussion   

This study has two major and related outcomes: we demonstrated consistency in the quantitative characterization of a mechanical process (sedimentary abrasion of flints), and we compared the quality of the quantitative features extracted from the images taken by two different microscopes.    
The consistency of the quantitative characterization of a mechanical process was tested by comparing metric features extracted from the images taken by two different microscopes. Three aspects were found to contribute to this consistency: most of the extracted metric features presented the same trends in both microscopes; classification models (LDA) trained on images from the microscopes presented similar values of accuracy; and the same (or analogous/highly collinear) features were considered important for classification by the LDA models trained on each microscope. This indicates that the changes in metric features are correctly capturing changes in the surface due to a mechanical process.     
The quality of the metric features extracted from the images from the two microscopes was compared through number of collinear features and classification accuracy of the LDA models. The Sensofar S neox 090 images can be considered to provide a better set of quantitative features, since there is a smaller number of collinear variables. Fewer correlated features are indicative of a more comprehensive characterization of a surface, since more distinct features are available (instead of collinear/redundant). However, the lower quality of the images (in the form of a higher presence of collinear variables) did not imply a drawback for the LDA models trained on the Dino-Lite Edge 3.0 AM73915MZT images, which presented classification performance values similar to those of LDA models trained on the Sensofar S neox 090 images. This indicates that the given task (classification of sedimentary abrasion stages) can be accurately performed with both microscopes despite differences in the quality of the quantitative features.    

Because chrono-cultural interpretations are derived from lithic archaeological assemblages, determining the integrity of such assemblages is a key aspect of Paleolithic archaeology [@dibble_taphonomy_2006; @galland_quantifying_2019]. Previous research has shown that unaided visual assessments of sedimentary abrasion (rounding) can result in an error ratio exceeding 80% [@chambers_like_2016].Therefore, the integrity of lithic assemblages must be determined through microscopic analysis, which, ideally, should study a range of variables and focus primarily on ridge width and surface abrasion [@burroni_surface_2002; @bustos-perez_experimental_2019; @chambers_like_2016; @chu_micro-abrasion_2015; @shackley_stream_1974]. 
Results from the present study reinforce the quantitative characterization of surface change due to sedimentary abrasion [@bustos-perez_quantification_2024]. This ensures the reliability of the set of quantitative features extracted, and strengthens the methodological background of studies focusing on postdepositional processes using the quantification of surface alteration.    

Although the three classes of surface studied here were a priori easily differentiable, there was a certain degree of confusion in their classification. However, this should not be considered a problem. Previous work [@bustos-perez_quantification_2024] has shown that abrasion develops unevenly among lithic artifacts. In some images, abrasion was minimally developed after ten hours (and classified as fresh), while in others abrasion was heavily developed after the same treatment (up to the point they were identified as neocortex).    
Current research on use-wear combines quantitative features extracted from microscope images and machine learning models to generate information on feature importance [@ibanez_quantitative_2021; @pedergnana_polish_2020; @sferrazza_grey_2023]. However, the present study has shown the importance of testing for multicollinearity among the quantitative features extracted from microscope images. Previous research [@bustos-perez_quantification_2024] considered CONT, Rq and SD as three of the four top variables according to mean importance. The current study shows that these three variables are highly correlated. While the present research shows that this does not affect results of classification, it does attenuate the interpretation of feature importance. Therefore, although it does not affect classification performance, collinearity between selected features should always be considered prior to variable importance interpretation. This is a common aspect for machine learning workflows [@james_introduction_2013; @naes_understanding_2001; @yang_why_2003].   

When comparing the distribution values of the images taken by the two microscopes (Figures 4 to 7), the Dino-Lite Edge 3.0 AM73915MZT images seem to be more sensitive to changes due to sedimentary abrasion with more visible trends in quantitative variable changes. For the Sensofar S neox images, no statistical differences were found in six of fifteen features on fresh flint and flint that had undergone 10 hours of rounding. However, this did not result in a problem for the LDA models. One of the advantages of machine learning models resides in their ability to combine multiple features for classification. Features with no statistical differences between groups might become important when combined with an additional feature. Thus, it comes as no surprise that the LDA model trained on the Sensofar S neox selected a measure of central tendency (median) as an important feature for classification.   
An additional possible explanation is that the variables employed for calculation were not adequate for the Sensofar S neox and are better suited for images from the Dinolite. Our observation of trends indicates that, for the given task, and under the given parameters, the set of quantitative variables seems to be better suited for images coming from the Dino-Lite Edge 3.0 AM73915MZT. Analyses using confocal mode commonly implement the ISO 25178 or ISO 25178–2 [@ibanez_quantitative_2021; @pedergnana_polish_2020] with surface parameters (Sq, Sv, Str, etc.) differing from the roughness parameters (Rq, Ra, Rsk, and Rku) employed in the present study (ISO 4287/2000). This could be indicative that the ISO 4287/2000 parameters are better suited for the Dino-Lite Edge 3.0 AM73915MZT, while those of the ISO 25178 are better suited for the Sensofar S neox.    

## 5) Conclusions      

Postdepositional alterations and assemblage integrity are fundamental analyses in the study of Paleolithic lithic assemblages. Microscopic analysis plays a crucial role in accurately assessing the extent of postdepositional alteration in lithic artifacts, and this degree of alteration can be determined by examining the abrasive erosion of flint surfaces. Therefore, it is critical to ensure that the quantitative features of this mechanical process are correctly characterized to obtain reliable results. In the present study, the metric features extracted from the images generated by two microscopes presented similar trends, similar classification accuracy, and similar variable importance. This made it possible to address the issue of microscope agnosticism regarding the development of surface abrasion. Additionally, using the workflow presented here, the quality of quantitative variables extracted from microscope images can be evaluated. In order to compare the quality of the quantitative features extracted from the images taken by two different microscopes, it is important to: 1) compare observed trends among the quantitative variables; 2) compare collinearity among variables (generally speaking, images from microscopes with fewer collinear variables are better); 3) compare classification accuracy among same models; 4) compare feature importance considering collinearity among the predictors.    

## 6) Acknowledgments    

The authors would also like to thank Juan Luis Fernández-Marchena for his comments and suggestions during the development of the present work. The following research has been possible thanks to the Program for the Requalification of the University System Margarita Salas (CA1/RSUE/2021-00743) financed through the Spanish “Recovery, Transformation and Resilience Plan” and managed from the Ministry of Universities (Ministerio de Universidades) and the Autonomous University of Madrid (Universidad Autónoma de Madrid). This work has been carried out with the financial support of the Generalitat de Catalunya, AGAUR agency (2021SGR01239 Research Group), Universitat Rovira i Virgili (2022PFR-URV-64), and the PID2021-122355NB-C32 project, funded by MCIN/AEI/10.13039/501100011033 and by “ERDF: A way of making Europe”. The Institut Català de Paleoecologia Humana i Evolución Social (IPHES-CERCA) has received financial support from the Spanish Ministry of Science and Innovation through the “María de Maeztu” program for Units of Excellence (CEX2019-000945-M). This work is also related to project reference PID2022-138590NB-C42, financed by the Agencia Estatal de Investigación: “On the limits of diversity: Neanderthal behavior in the central and southern Iberian Peninsula (2)”    

## 7) References   


</div> 